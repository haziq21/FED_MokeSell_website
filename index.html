<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MokeSell</title>

    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <link rel="stylesheet" href="shared/reset.css">
    <link rel="stylesheet" href="shared/base.css">
    <link rel="stylesheet" href="shared/navbar.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/@dotlottie/player-component@2.7.12/dist/dotlottie-player.mjs" type="module"></script>
    <style>
        [x-cloak] {
            display: none !important;
        }
    </style>
    <script type="module" src="script.js"></script>
</head>

<body x-data="listings">
    <nav class="navbar" x-data="nav">
        <img src="assets/logo.png" alt="MokeSell logo" class="navbar__logo">
        <input type="text" placeholder="Search MokeSell" class="textbox textbox--search">

        <a href="signup" class="navbar__btn" x-cloak x-show="showPfp === false">Sign up</a>
        <a href="login" class="navbar__btn" x-cloak x-show="showPfp === false">Log in</a>

        <a href="new-listing" class="navbar__btn" x-cloak x-show="showPfp">Create listing</a>
        <img src="assets/default-pfp.jpg" alt="Profile picture" class="navbar__pfp" x-cloak x-show="showPfp"
            @click="dropdownOpen = !dropdownOpen">
        <ul x-show="dropdownOpen" class="dropdown">
            <li><a href="my-listings/">My Listings</a></li>
            <li><a href="new-listing/">New Listing</a></li>
            <li><a href="">Log Out</a></li>
        </ul>
        <div class="category-selector" @mouseleave="activeCat = null">
            <ul class="categories">
                <template x-for="cat in categories">
                    <li @mouseover="activeCat = cat.category"><a href="#" x-text="cat.category"></a></li>
                </template>
            </ul>

            <template x-for="cat in categories">
                <ul class="subcategories" x-show="activeCat === cat.category">
                    <template x-for="subcat in cat.subcategories">
                        <li><a href="#"><img src="assets/logo.png" alt=""><span x-text="subcat"></span></a></li>
                    </template>
                </ul>
            </template>
        </div>
    </nav>

    <main class="content">
        <h1 class="section-header">Recent listings</h1>

        <ul class="listings">
            <template x-for="l in listings">
                <li class="listing">
                    <a :href="`listing/?id=${l.id}`" class="display-contents">
                        <img src="assets/default-pfp.jpg" alt="Profile picture" class="listing__pfp">
                        <span x-text="l.users.username" class="listing__username"></span>
                        <span x-text="l.age" class="listing__age"></span>
                        <img :src="l.thumbnail" alt="" class="listing__thumbnail">
                        <span x-text="l.name" class="listing__name"></span>
                        <span x-text="l.condition" class="listing__condition"></span>
                        <span x-text="`S\$${l.price.toFixed(2)}`" class="listing__price"></span>
                    </a>
                </li>
            </template>
        </ul>
    </main>
    <dotlottie-player class="animation" src="https://lottie.host/642ed790-d54c-415e-997a-6bc611956ed9/4ZjZHGYPCH.lottie"
        background="transparent" speed="1" style="width: 300px; height: 300px" loop autoplay></dotlottie-player>
</body>

</html>